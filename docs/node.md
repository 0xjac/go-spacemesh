## Node, Accounts, Keys and Ids

### `Node`
An Internet-connected computer running the `Unruly Node` software. Each node is identified by a public `Node Id`. 
The `Node Id` is the public key in a key-pair generated on node first run and persisted in node's settings file.

### `Peer`
A peer is a node which is connected to another node over the Internet and has established a secure and authenticated session with that node. 
So each `p2p message` is coming from a peer but may be authored by another node on the network. Our p2p code supports full authentication of the message's sender and the message's author.

### Node IDs and Keys

#### Keys
- Node pub and priv keys are `Secp256k1` keys.
- A key `binary representation` is the key raw binary value. For public keys, this is the 33 bytes compressed format.
- A key `string representation` is a `base58` encoding of the key `binary representation`
- Private keys are 32 bytes long
- Public key may be created from a 65 bytes uncompressed format
- A public key is used for accounts and nodes ids. There is no separate id derived from the public key.
- A Public key may be dervied from a private key.

### `Accounts`

#### Users Accounts
A `user account` belongs to a real user who has access to the account's private key and passphrase. 
It is created via the `node api` using `ECC`. e.g. User generates a `secp256k1` key pair and the account identity is the public key.

- Maintains the user's `Unrulies` balance.
- Maintains the user's state for `Smart Contract Templates`
- The canonical Unruly identity is the base58 encoding of the account's public key.
To create an account, a `Scep256k1` key pair is generated by the user. The private key is stored encrypted with user-provided password.
- Nonce - incremented when a user's transaction is added to a block. Used to avoid adding more than one copy of user's transaction in a block.
- Each account has a `key store` file which contains the account id, private key and salt. The private key is encrypted using the user's passphrase in store.
- A node has access to key store files (one per account) (at well-known dir) so it can accept passphrase as method param to unlock any such account for a runtime session.
- Node may be command-line started with a list of account ids to unlock and to set the `coinbase account` (used for mining awards). the `coinbase account` is a default account for usage in a session. It must have a key store file.
- Node API methods will have versions that accept account signature on input data - this allows node to execute a method on behalf of an account without access to the account private key. e.g. send a transaction to the network on behalf of the user. (This is how Infura works together with MetaMask and other eth wallets).

#### Smart Contract Accounts
In addition to user account data, a smart contract account includes:
- deployed smart contract code
- deployed version #
- Current smart contract state
- Deploying user account id
- Same pub/private key and id setup as user account

#### Smart Contract Templates
A smart contract template is a deployed smart contract code without singleton state. The state of template instances are managed under user accounts. In other words, the template provides the deployed code and the state differs per user. This is useful for scenarios where the same smart contract is used by millions of users. Using template, 1 million copies of the code don't need to be deployed on the blockchain - only 1. The state is maintained for each smart code user.




