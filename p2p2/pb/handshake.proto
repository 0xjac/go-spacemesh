syntax = "proto3";

package pb;
option go_package = "pb";

// Handshake protocol message format

// used for both request and response - sent unencrypted on the wire
message HandshakeData {
    bytes nodePubKey = 1; // 65 bytes uncompressed
    bytes iv = 2; // 16 bytes - AES-256-CBC IV
    bytes pubKey = 3; // 65 bytes (uncompressed) ephemeral public key
    bytes hmac = 4; // HMAC-SHA-256 32 bytes
    string sign = 5; // hex encoded string 32 bytes sign of all above data by node public key (verifies he has the priv key and he wrote the data
}

